# 編集の仕方
master ブランチの `source` ディレクトリ内にあるファイルを編集すると，
変更が [release ブランチ](https://github.com/fiveseven-lambda/biochemistry/tree/release)の
[`index.html`](https://github.com/fiveseven-lambda/biochemistry/blob/release/index.html) に反映されます
（ master ブランチに `index.html` は存在しません）．
[github.io](https://fiveseven-lambda.github.io/biochemistry/) では release ブランチの `index.html` の内容を表示しています．

# 文法
記事の中身は，次の要素を並べていくことで記述します．
```
ID [名前] +分類{ 説明 }
```
## ID
ID は，各々の化合物に別々に付ける名前です．
アルファベット，数字，ハイフン `-`，カンマ `,` が使えます．
たとえば， `glucose` や `fructose-1,6-bisphosphate` などが ID として使えます．
現在は，原則的に化合物の英語名を ID とすることにしています．

ID は，記事の文中には現れません．しかし，ページ url の最後に `#` と ID を付けると，各化合物へのリンクになります（ HTML の `id` 属性です）．

## 名前
ID の後に角括弧 `[ ]` でくくって名前を書くと，各々の化合物の見出しとなります．

たとえば， `glucose [グルコース]` と書くと，見出し名が「グルコース」になります．

ここでは後で説明するマークダウンが使えます．

- 名前を省略して， `glucose +分類{ 説明 }` のように書いてもかまいません．

## 分類
`+`の直後には，
「解糖系」「糖新生」「クエン酸回路」など，
その化合物がどんな代謝経路に属しているかを表す単語を書きます．

分類は，見出し名の右に，緑の文字で表示されます．

- 分類を省略して `+{ 説明 }` としてもかまいません．

## 説明
波括弧 `{ }` でくくった部分に，化合物の詳細な説明を書きます．ここでは下で説明するマークダウンが使えます．

`+分類{ 説明 }` の部分は，並べて複数個書いてもかまいません．たとえば，

```
glucose [グルコース]
+{ 6 炭糖である． }
+{ グリコーゲンとして貯蔵される． }
```

のように書いて，グルコースに対して複数個の説明をくわえることができます．
`+{ }` ごとに段落分けされます（ 1 つの `+{ }` の中で改行しても，記事には反映されません）．

# 記事の生成
上の文法に従って並べられた要素は，
 ID が同じものが集められます．

たとえば，ファイル内の数箇所に渡って

```
glucose [グルコース] +{ 6炭糖である． }
︙
glucose +グリコーゲン代謝{ グリコーゲンとして貯蔵される． }
︙
glucose +解糖系{ ヘキソキナーゼによってグルコース 6-リン酸に変換される． }
```

のようにグルコースの説明が書かれていた場合，
これらは全て ID （ `glucose` ）が同じなので，
1 箇所に集められます．

- 1 つの ID に対し，
  角括弧の中の名前 `[グルコース]` が複数個付けられているとき，
  これらは全て同じでなければいけません．
  たとえば，
  ```
  glucose [グルコース] +{}
  glucose [グルコース2] +{}
  ```
  のように同じ ID に異なる名前が付けられているとエラーになります．
- ID に 1 つも名前が付いていない場合もエラーになります．
- `+`の後に書かれた分類が複数あるとき，
  記事中では「・」で連結して書かれます．

# マークダウン
以下のマークダウンが使えます．
## 上付き，下付き
`^` は直後の 1 文字を上付き， `_` は直後の 1 文字を下付きにします．
たとえば `H_2O` と書くと `2` が下付きになります．

複数の文字を上付き/下付きにしたいときは， `Mg^{2+}` のように波括弧 `{ }` でくくります．

また，
`ヘキソキナーゼ_(ATP→ADP)` のように丸括弧 `( )` でくくると，
括弧ごと上付き/下付きになります．
これは，今のところ酵素の性質（可逆/不可逆，依存する補酵素など）を書くときに使っています．

## リンク
説明の中で `[グリコーゲン]` のように角括弧 `[ ]` でくくって名前を書くと，
`[グリコーゲン]` という名前の付いた化合物へのハイパーリンクになります．

例：
```
glucose [グルコース] +グリコーゲン代謝{
    グルコースは動物体内で[グリコーゲン]として貯蔵される．
}
glycogen [グリコーゲン] +グリコーゲン代謝{
    [グルコース]の貯蔵に用いられる．
}
```
こうしておくと，
記事中のグルコースの説明の「グリコーゲン」をクリックして
グリコーゲンの説明に飛ぶことができます．

## エスケープ
`^` や `_` といった文字そのものを書きたいときは，
バックスラッシュ `\` を付けて `\^` や `\_` とすると，
上付き/下付きの記号ではなく，
その文字自体になります．

# 複数ファイルの連結

`source` ディレクトリ内には，
複数のファイルを書くことができます．

ファイル名は先頭に番号を付け， `10_糖` や `20_クエン酸回路` のように命名します．
すると，これらのファイルは番号の小さい順に並べられ，
中身が連結されます．

すなわち， `10_糖` というファイルに
```
glucose [グルコース] 
```
と書いて， `20_クエン酸回路` というファイルに
```
citric-acid [クエン酸]
```
と書くのは， `10_代謝` という 1 つのファイルに
```
glucose [グルコース] 
citric-acid [クエン酸]
```
と書いたのと同じことになります．


補足：
- 先頭に番号の付いていないファイルは無視されます．
- 同じ番号のついたファイルが複数存在すると，エラーになります．

# 例
実際の記述の仕方の例は，
[ここ](https://github.com/fiveseven-lambda/biochemistry/tree/master/source)から見ることができます．

# 手元の環境構築
Rust を用いているため，
編集した結果を手元で確認するには Rust の環境が必要になります．

```
$ cd converter
$ cargo build --release
$ cd ..
$ converter/target/release/converter
```

を実行していただくことで，ファイル `index.html` が作られます．

converter を `converter` や `source` の下で実行すると
「カレントディレクトリ下に `source` が見つからない」と怒られるので注意してください．